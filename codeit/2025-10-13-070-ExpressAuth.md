# ğŸ—“ï¸ 2025-10-13 TIL 70ì¼ì°¨

## âœ… ì˜¤ëŠ˜ì˜ ì„±ì·¨ (ì˜í•œ ì )

- ì˜ˆ
- ì˜ˆ

---

## ğŸ“š ì˜¤ëŠ˜ì˜ í•™ìŠµ (ë°°ìš´ ì )

### ğŸ”¹ í•µì‹¬ ì£¼ì œ

1. MVC

### ğŸ”¹ ì£¼ìš” ê°œë… ì •ë¦¬

### ğŸ”¹ ì˜ˆì œ ì½”ë“œ

<details>
<summary style="font-size: 22px;">ğŸ““ ë©”ëª¨ì¥</summary>

# Express Auth

```shell
express-user-system/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ controllers/     # ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬ ë° ì„œë¹„ìŠ¤ ê³„ì¸µ ì—°ê²°
â”‚   â”œâ”€â”€ services/        # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
â”‚   â”œâ”€â”€ repositories/    # ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—… ì²˜ë¦¬
â”‚   â”œâ”€â”€ middlewares/     # ë¯¸ë“¤ì›¨ì–´ í•¨ìˆ˜ë“¤
â”‚   â”œâ”€â”€ config/         # í™˜ê²½ ì„¤ì • ê´€ë ¨ íŒŒì¼ë“¤
â”‚   â””â”€â”€ app.js          # ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ì 
â”œâ”€â”€ prisma/             # Prisma ìŠ¤í‚¤ë§ˆ ë° ë§ˆì´ê·¸ë ˆì´ì…˜
â”œâ”€â”€ http/               # API í…ŒìŠ¤íŠ¸ìš© HTTP ìš”ì²­ íŒŒì¼ë“¤
â”œâ”€â”€ .env               # í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
â””â”€â”€ package.json       # í”„ë¡œì íŠ¸ ì„¤ì • ë° ì˜ì¡´ì„±

# Client ìš”ì²­ â†’ Controller â†’ Service â†’ Repository â†’ Prisma(Database)
```

## Controller

1. ìš”ì²­ íŒŒì‹±

- req.params, req.query, req.body, ì¿ í‚¤/í—¤ë” ì¶”ì¶œ

2. ìš”ì²­ ìœ íš¨ì„± ê²€ì‚¬ (í˜•ì‹/í•„ìˆ˜ê°’)

- ë¹ ë¥¸ 4XX ì²˜ë¦¬ (ì˜ˆ: í•„ìˆ˜ í•„ë“œ ì—†ìœ¼ë©´ 422)

3. ì¸ì¦/ì¸ê°€ ê²°ê³¼ í™œìš©

- ë¯¸ë“¤ì›¨ì–´ê°€ ì„¤ì •í•œ req.user ì‚¬ìš©

```js
// authMiddleware.js
export default function auth(req, res, next) {
  // ì˜ˆ: JWT ë””ì½”ë“œ í›„
  // const { userId, role } = verify(token)
  req.user = { userId: 1, role: "user" };
  next();
}

// app.js
app.use(auth);
```

4. ì„œë¹„ìŠ¤ í˜¸ì¶œ

- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ í˜¸ì¶œë§Œ

5. ì‘ë‹µ êµ¬ì„±

- ìƒíƒœì½”ë“œ/í—¤ë”/ë°”ë”” ê²°ì •

6. ì—ëŸ¬ ìœ„ì„

- try/catchì—ì„œ next(error)ë¡œ ì¤‘ì•™ ì—ëŸ¬ í•¸ë“¤ëŸ¬ì— ì „ë‹¬

7. í•˜ì§€ ë§ì•„ì•¼ í•  ê²ƒ

- DB ì ‘ê·¼, ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ êµ¬í˜„, ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ ë“±

> #### ì™¸ ì•Šë˜?
>
> 1. ì—­í•  ë¶„ë¦¬ ì›ì¹™
>
> - ControllerëŠ” ê¸°ë³¸ì ìœ¼ë¡œ HTTP ìš”ì²­ì„ ë°›ì•„ ì ì ˆí•œ ì„œë¹„ìŠ¤ ë ˆì´ì–´ì— ì „ë‹¬, ê²°ê³¼ë¥¼ í´ë¼ì´ì–¸íŠ¸ì— ë°˜í™˜
> - DB ì§ì ‘ ì¡°íšŒì‹œ
>   - DB êµ¬ì¡°ê°€ ë°”ë€Œë©´ Controllerê¹Œì§€ ìˆ˜ì •í•´ì•¼í•´ ìœ ì§€ë³´ìˆ˜ ì–´ë µ~
>   - í…ŒìŠ¤íŠ¸ë„ ì–´ë ¤ì›Œì§
>
> â‡’ ìš”ì²­ê³¼ ì‘ë‹µë§Œ ë‹´ë‹¹! ì‹¤ì œ ë¡œì§ì€ Service / Modelì—ì„œ ì²˜ë¦¬í•˜ëŠ”ê²Œ ê¹”ë”!
>
> 2. ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™(ë¡œì§) êµ¬í˜„
>
> - íšŒì›ê°€ì… ì‹œ ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸, í¬ì¸íŠ¸ ì ë¦½ ê³„ì‚° ë“±
> - Controllerì—ì„œ ì´ëŸ° ê·œì¹™ êµ¬í˜„ì‹œ
>   - ë¡œì§ì´ Controllerì— í©ì–´ì ¸ ì¬ì‚¬ìš© ì–´ë µ
>   - ë‹¤ë¥¸ ê³³ì—ì„œë„ ê°™ì€ ë¡œì§ì„ ì¨ì•¼ í•œë‹¤ë©´ ì½”ë“œ ì¤‘ë³µ ë°œìƒ
>
> â‡’ Service ê³„ì¸µì—ì„œ ì²˜ë¦¬ì‹œ ì—¬ëŸ¬ Controllerì—ì„œ ì¬ì‚¬ìš© ê°€ëŠ¥ & í…ŒìŠ¤íŠ¸ EZier
>
> 3. ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ
>
> - `bcrypt` ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ìš©í•´ ë¹„ë°€ë²ˆí˜¸ í•´ì‹œí•  ë•Œë„ Controllerì—ì„œ ë°”ë¡œ í•˜ê¸° ê¸ˆì§€
>   - ë³´ì•ˆ ë¡œì§ì´ Controller ì•ˆì— ìˆìœ¼ë©´ ë‚˜ì¤‘ì— ìˆ˜ì •í•˜ê±°ë‚˜ ë‹¤ë¥¸ ì¸ì¦ ë°©ì‹ ë„ì…ì‹œ Controller ì „ì²´ ê±´ë“œë ¤ì•¼ í•¨
>   - Serviceë‚˜ Auth Helper ê°™ì€ ë³„ë„ ëª¨ë“ˆì—ì„œ ì²˜ë¦¬í•˜ë©´ ê¹”ë”í•œ ì½”ë“œë¥¼ ì•ˆì „íˆ ê´€ë¦¬ ê°€ëŠ¥
>
> | ê³„ì¸µ             | ì—­í•                                               |
> | ---------------- | ------------------------------------------------- |
> | Controller       | ìš”ì²­ ì²˜ë¦¬, ì„œë¹„ìŠ¤ í˜¸ì¶œ, ì‘ë‹µ ë°˜í™˜                 |
> | Service          | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬, ë°ì´í„° ê²€ì¦, ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ ë“± |
> | Model/Repository | DB ì ‘ê·¼                                           |

## Service

> #### ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ ì¤‘ì‹¬
>
> ë„ë©”ì¸ ê·œì¹™, ì‹œë‚˜ë¦¬ì˜¤ íë¦„ (ê°€ì…Â â†’ ì¤‘ë³µí™•ì¸Â â†’ í•´ì‹œÂ â†’ ì €ì¥)

1. ë„ë©”ì¸ ìœ íš¨ì„± ê²€ì‚¬

- ê·œì¹™ ê²€ì¦: í•´ë‹¹ ì‚¬ìš©ì ì¡´ì¬ ì—¬ë¶€, ê¶Œí•œ/ìƒíƒœ ì²´í¬

2. íŠ¸ëœì­ì…˜/ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜: ì—¬ëŸ¬ Repository í˜¸ì¶œ ë¬¶ê¸° // QUES: ì™œ..?

- ì—¬ëŸ¬ ì €ì¥/ìˆ˜ì •ì´ í•œ ë¬¶ìŒ(ì›ìì„±)ì´ì–´ì•¼ í•  ë•Œ ì„œë¹„ìŠ¤ê°€ íŠ¸ëœì­ì…˜ ê²½ê³„ ì¡ëŠ” ê²ƒì´ ì¼ë°˜ì 
- ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ í˜¸ì¶œ & ì›ìì„± í•„ìš”ì‹œ ìƒìœ„ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ì„œë¹„ìŠ¤(ì»´í¬ì§€íŠ¸ ì„œë¹„ìŠ¤)ë¥¼ ë§Œë“¤ì–´
  - ê·¸ ì•ˆì—ì„œ í•œ ë²ˆì˜ íŠ¸ë Œì ì…˜ìœ¼ë¡œ ë¬¶ê¸° ê°€ëŠ¥
  - ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë”°ë¡œë”°ë¡œ í˜¸ì¶œì‹œ ì •í•©ì„± ê¹¨ì§ˆ ìˆ˜ O

3. ì¸í”„ë¼ ì—°ë™

- ì™¸ë¶€ API, í, ìºì‹œ, ì•”í˜¸í™”/í•´ì‹œ ë“± // QUES: íê°€ ì™œ ì¸í”„ë¼..?

4. ë°ì´í„° ê°€ê³µ

- ë°˜í™˜ìš© ë§ˆìŠ¤í‚¹/ì •ê·œí™” (ì˜ˆ: ë¹„ë°€ë²ˆí˜¸ ì œê±°)

5. ì—ëŸ¬ ìƒì„±/ì „íŒŒ

- ì˜ë¯¸ ìˆëŠ” ì—ëŸ¬(ì½”ë“œ/ë©”ì„¸ì§€)ë¡œ throw â†’ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ìƒíƒœì½”ë“œ ë§¤í•‘

6. í•˜ì§€ ë§ì•„ì•¼ í•  ê²ƒ

- HTTP ì„¸ë¶€(req, res, ìƒíƒœì½”ë“œ), í”„ë ˆì„ì›Œí¬ ì˜ì¡´ ì²˜ë¦¬ // QUES: í”„ë ˆì„ì›Œí¬ê°€ í”„ë¡ íŠ¸ì—”ë“œë‹¨ ë§í•˜ëŠ”ê±´ê°€?
  - ê°€ê¸‰ì  í”„ë ˆì„ì›Œí¬ì˜ req, res ë“±ì„ ì„œë¹„ìŠ¤ì—ì„œ ì²˜ë¦¬í•˜ì§€ ë§ìëŠ” ëœ»
  - ì„œë¹„ìŠ¤ëŠ” `ìˆœìˆ˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— ì§‘ì¤‘`í•´ì•¼í•œë‹¤ëŠ” ì›ì¹™

> ### ì™œ..?
>
> 1. ì™œ íŠ¸ëœì­ì…˜/ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜(ì—¬ëŸ¬ Repository í˜¸ì¶œ ë¬¶ê¸°) í•„ìš”í• ê¹Œ?  
>    ë°ì´í„° ì¼ê´€ì„±ì„ ìœ„í•´ ì¼ê´€ì„± ìˆëŠ” ì‘ì—…ì„ Controllerì—ì„œ ê°ê° í˜¸ì¶œX  
>    íŠ¸ëœì­ì…˜ ê²½ê³„ë¥¼ ì„œë¹„ìŠ¤ ë ˆë²¨ì—ì„œ ì¡ì•„ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ê¸°
>
> 2. íê°€ ì™œ ì¸í”„ë¼ì¼ê¹Œ?  
>    ë°ì´í„°ë² ì´ìŠ¤ì™€ ê°™ì€ ì™¸ë¶€ ì‹œìŠ¤í…œ (ë©”ì„¸ì§€ í: RabbitMQ, Kafka - ë¹„ë™ê¸° ì²˜ë¦¬ ì¸í”„ë¼)
>
> 3. ë°±ì—”ë“œ í”„ë ˆì„ì›Œí¬ ì˜ì¡´ ê¸ˆì§€  
>    `req, res ê°ì²´`, `HTTP status code`ëŠ” í”„ë ˆì„ì›Œí¬ ë ˆë²¨ì˜ ì±…ì„  
>    Service ë ˆì´ì–´ì—ì„œëŠ” ìˆœìˆ˜ js,ts ê°ì²´ë¥¼ ë°›ì•„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë§Œ ì²˜ë¦¬í•  ê²ƒ
>
> - í•˜ì§€ ë§ì•„ì•¼ í•  ì˜ˆì‹œ
>
> ```js
> async function createUser(req, res) {
>   // âŒ Serviceê°€ HTTPì— ì˜ì¡´
>   const user = await userRepository.save(req.body);
>   res.status(201).json(user);
> }
> ```
>
> - ì˜¬ë°”ë¥¸ ì˜ˆì‹œ
>
> ```js
> // Controller
> async function createUserController(req, res) {
>   const result = await userService.createUser(req.body);
>   res.status(201).json(result);
> }
>
> // Service
> async function createUser(data) {
>   const user = await userRepository.save(data);
>   return user;
> }
> ```

## Repository

> #### ë°ì´í„° ì ‘ê·¼ ì „ë‹´
>
> Prisma/ORM ì´ìš©í•œ CRUD, ì¿¼ë¦¬ ìµœì í™”

1. DB íŠ¸ëœì­ì…˜ ë‹¨ìœ„ ì‘ì—…

- ì œê³µëœ íŠ¸ëœì­ì…˜ ì»¨í…ìŠ¤íŠ¸ ë‚´ì—ì„œ ì¿¼ë¦¬ ì‹¤í–‰
  - ì´ íŠ¸ëœì­ì…˜ ë‹¨ìœ„ì˜ ì œê³µì€ `Service`ì—ì„œ!

2. DB ì œì•½ í™œìš©

- ìœ ë‹ˆí¬/ì™¸ë˜í‚¤ ë“± ìŠ¤í‚¤ë§ˆ ë ˆë²¨ ë³´ì¥

3. ìˆœìˆ˜í•¨ ìœ ì§€

- ì…ë ¥ ë°ì´í„° ê·¸ëŒ€ë¡œ ì €ì¥/ì¡°íšŒ, ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™XX

4. ì˜ˆì™¸ ì²˜ë¦¬

- ORM ì—ëŸ¬ëŠ” ê°€ê¸‰ì  ë˜í•‘ ì—†ì´ ê·¸ëŒ€ë¡œ ìƒìœ„(Service)ë¡œ ì „íŒŒí•  ê²ƒ

5. í•˜ì§€ ë§ì•„ì•¼ í•  ê²ƒ

- HTTP ì‘ë‹µ/ìƒíƒœ, ë„ë©”ì´ ê·œì¹™ íŒë‹¨, ìš”ì²­ í˜•ì‹ ê²€ì¦

### ì˜ˆì‹œ

```js
// app.js
...
app.use('/products', productController);
app.use(errorHandler);
...

// controllers/productController.js
const productController = express.Router();

productController.post('/', async (req, res, next) => {
  try{
    const createdProduct = await productService.create(req.body);
    return res.status(201).json(createdProduct);
  } catch(err) {
    return res.status(500).json({ message: err.message });
  }
});

productController.get('/:id', async (req, res) => {
  try {
    const { id } = req.params; // ìš”ì²­ íŒŒì‹±
    const product = await productService.getById(id); // ì„œë¹„ìŠ¤ í˜¸ì¶œ
    return res.status(200).json(product);
  } catch (err) {
    return res.status(500).json({ message: err.message });
  }
});

// services/productServices.js
async function getById(id) {
  const product = await productRepository.getById(id);
  if (!product) throw new Error('Product not found');
  return product;
}

async function create(product) {
  return await productRepository.save(product);
}

// repositories/productRepository.js
async function getById(id) {
  return await prisma.product.findUnique({
    where: {
      id: parseInt(id, 10),
    },
  });
}

async function save(product) {
  return await prisma.product.create({
    data: {
      name: product.name,
      description: product.description,
      price: parseInt(product.price, 10),
    },
  });
}
```

<details><summary>ì •ë¦¬ë³¸</summary>

### 1ï¸âƒ£ Controller (ì»¨íŠ¸ë¡¤ëŸ¬)

- **ì—­í• :** í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì„ ë°›ê³ , ì‘ë‹µì„ ë°˜í™˜í•˜ëŠ” ìµœì „ì„ .
- **ì±…ì„:**

  - HTTP ìš”ì²­(req)ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (query, params, body)
  - ì„œë¹„ìŠ¤ ê³„ì¸µ(service) í˜¸ì¶œ
  - HTTP ì‘ë‹µ(res) ë°˜í™˜
  - ì—ëŸ¬ ì²˜ë¦¬ ë° ìƒíƒœ ì½”ë“œ ì„¤ì •

- **ì£¼ì˜ì :** ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì—¬ê¸°ì— ë„£ì§€ ë§ê³ , ë‹¨ìˆœíˆ ìš”ì²­/ì‘ë‹µê³¼ ì„œë¹„ìŠ¤ í˜¸ì¶œë§Œ ë‹´ë‹¹.

**ì˜ˆì‹œ:**

```javascript
// controllers/userController.js
import userService from "../services/userService.js";

async function getUser(req, res) {
  try {
    const userId = req.params.id; // ìš”ì²­ URLì—ì„œ ID ì¶”ì¶œ
    const user = await userService.findUserById(userId); // ì„œë¹„ìŠ¤ í˜¸ì¶œ
    return res.status(200).json(user); // í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µ
  } catch (error) {
    return res.status(500).json({ message: error.message }); // ì—ëŸ¬ ì²˜ë¦¬
  }
}

export default {
  getUser,
};
```

---

### 2ï¸âƒ£ Service (ì„œë¹„ìŠ¤)

- **ì—­í• :** ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬ ê³„ì¸µ.
- **ì±…ì„:**

  - Controllerë¡œë¶€í„° ë°›ì€ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰
  - í•„ìš”í•œ ê²½ìš° ì—¬ëŸ¬ Repositoryë¥¼ ì¡°í•©í•´ì„œ ë°ì´í„° ì²˜ë¦¬
  - ì™¸ë¶€ API í˜¸ì¶œ, íŠ¸ëœì­ì…˜ ì²˜ë¦¬ ë“±

- **ì£¼ì˜ì :** DBë‚˜ HTTP ë ˆì´ì–´ì™€ ì§ì ‘ì ìœ¼ë¡œ ì„ì´ì§€ ì•Šê²Œ, Repositoryë¥¼ í†µí•´ ë°ì´í„° ì ‘ê·¼.

**ì˜ˆì‹œ:**

```javascript
// services/userService.js
import userRepository from "../repositories/userRepository.js";

async function findUserById(id) {
  // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§: ì‚¬ìš©ì ì¡´ì¬ ì—¬ë¶€ í™•ì¸
  const user = await userRepository.getUserById(id);
  if (!user) throw new Error("User not found");
  return user;
}

export default {
  findUserById,
};
```

---

### 3ï¸âƒ£ Repository (ë ˆí¬ì§€í† ë¦¬)

- **ì—­í• :** ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ, DBì™€ ì§ì ‘ í†µì‹ .
- **ì±…ì„:**

  - CRUD ì‘ì—… ìˆ˜í–‰ (Create, Read, Update, Delete)
  - DB ì¿¼ë¦¬ ì‘ì„± ë° ì‹¤í–‰
  - ë°ì´í„° ëª¨ë¸ ë³€í™˜

- **ì£¼ì˜ì :** ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ í¬í•¨í•˜ì§€ ì•Šê³ , ì˜¤ì§ DB ì ‘ê·¼ë§Œ ë‹´ë‹¹.

**ì˜ˆì‹œ:**

```javascript
// repositories/userRepository.js
const db = require("../models"); // ì˜ˆ: Sequelize ORM ëª¨ë¸

exports.getUserById = async (id) => {
  return await db.User.findByPk(id); // Sequelizeë¡œ DB ì¡°íšŒ
};
```

---

### ğŸ”‘ ì •ë¦¬

| ê³„ì¸µ       | ì±…ì„                                          |
| ---------- | --------------------------------------------- |
| Controller | HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬, ì„œë¹„ìŠ¤ í˜¸ì¶œ              |
| Service    | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬, ì—¬ëŸ¬ Repository ì¡°í•© ê°€ëŠ¥ |
| Repository | DB ì ‘ê·¼, CRUD ìˆ˜í–‰, ë°ì´í„° ëª¨ë¸ ê´€ë¦¬          |

- Controller â†’ Service â†’ Repository â†’ DB
- ì´ë ‡ê²Œ ê³„ì¸µì„ ë‚˜ëˆ„ë©´ **ì½”ë“œ ì¬ì‚¬ìš©ì„± â†‘, í…ŒìŠ¤íŠ¸ ìš©ì´ â†‘, ìœ ì§€ë³´ìˆ˜ ìš©ì´ â†‘**

</details>
</details>

---

## ğŸ§  ì˜¤ëŠ˜ì˜ ê°œì„  (ì–´ë µê±°ë‚˜ ì•„ì‰¬ì› ë˜ ì )

- ì˜ˆ
- ì˜ˆ

---

## ğŸš€ ë‚´ì¼ì˜ ê³„íš

- ì˜ˆ
- ì˜ˆ

---
